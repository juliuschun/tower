# Claude Desk â€” ë¦¬ì„œì¹˜/ë¶„ì„ íŒ€ì„ ìœ„í•œ Claude Code ì›¹ í”Œë«í¼

## Context

ì›ê²© ì„œë²„(Azure VM)ì—ì„œ Claude Codeë¥¼ ëŒë¦¬ê³  ë¸Œë¼ìš°ì €ì—ì„œ ì ‘ì†í•˜ëŠ” í™˜ê²½.
SDK ê¸°ë°˜ + ê¹”ë”í•œ UI + íŒŒì¼/ì—ë””í„°ë¥¼ ê²°í•©í•œ ìì²´ í”Œë«í¼.

**íƒ€ê²Ÿ ìœ ì €:** ë¦¬ì„œì¹˜/ë¶„ì„ íŒ€ (ë¹„ê°œë°œì í¬í•¨)
**í•µì‹¬ ë‹ˆì¦ˆ:** Claudeì™€ ëŒ€í™”í•˜ë©° ë¦¬ì„œì¹˜ â†’ MD ë³´ê³ ì„œ ë Œë”ë§ â†’ íŒŒì¼ í¸ì§‘

**ë¹„-ëª©í‘œ (Non-goals):**
- ë©€í‹° ì„œë²„ í´ëŸ¬ìŠ¤í„°ë§ / ìˆ˜í‰ ìŠ¤ì¼€ì¼ë§ (ë‹¨ì¼ VM ì „ì œ)
- ì‹¤ì‹œê°„ í˜‘ì—… (ë™ì‹œ í¸ì§‘, ì»¤ì„œ ê³µìœ  ë“±)
- Claude API ì§ì ‘ í˜¸ì¶œë¡œ SDK ìš°íšŒ

---

## Tech Stack

| ë ˆì´ì–´ | ì„ íƒ | ì´ìœ  |
|--------|------|------|
| **Frontend** | React 18 + Vite + TailwindCSS v4 | ê²€ì¦ë¨ |
| **Backend** | Express + WebSocket (ws) | HTTP + ì–‘ë°©í–¥ ì‹¤ì‹œê°„ |
| **Claude ì—°ë™** | @anthropic-ai/claude-agent-sdk | PTY ì•„ë‹Œ SDK, Skills ì§€ì› |
| **ì—ë””í„°** | CodeMirror 6 (@uiw/react-codemirror) | ê°€ë³ê³  ëª¨ë°”ì¼ ì§€ì› |
| **MD ë Œë”ë§** | react-markdown + remark-gfm + rehype-highlight | GFM, ì½”ë“œ í•˜ì´ë¼ì´íŒ… |
| **DB** | better-sqlite3 | ì„¸ì…˜, ìœ ì €, ë©”ì‹œì§€ |
| **ìƒíƒœê´€ë¦¬** | zustand | ë‹¨ìˆœ |
| **ì–¸ì–´** | TypeScript | í”„ë¡ íŠ¸/ë°±ì—”ë“œ ëª¨ë‘ |

---

## UI ë ˆì´ì•„ì›ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HEADER: ë¡œê³  Â· ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì„ íƒ Â· ì„¸ì…˜ ì´ë¦„ Â· ì„¤ì •  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ LEFT   â”‚    CENTER               â”‚   RIGHT           â”‚
â”‚ SIDEBARâ”‚    CHAT PANEL           â”‚   CONTEXT PANEL   â”‚
â”‚ ì„¸ì…˜   â”‚  [ë©”ì‹œì§€ ë²„ë¸”]           â”‚  MD ë Œë” ë·°ì–´     â”‚
â”‚ íˆìŠ¤í† ë¦¬â”‚  [ë„êµ¬ ì‚¬ìš© ì¹´ë“œ]        â”‚  ì½”ë“œ ì—ë””í„°      â”‚
â”‚ í”„ë¡¬í”„íŠ¸â”‚  [ì‚¬ê³  ê³¼ì • ì ‘ê¸°]        â”‚  HTML iframe      â”‚
â”‚ íŒŒì¼   â”‚                         â”‚  íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°     â”‚
â”‚ íŠ¸ë¦¬   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  í”„ë¡¬í”„íŠ¸ ë¯¸ë¦¬ë³´ê¸° â”‚
â”‚ ë²„ì „   â”‚  â”‚ ì…ë ¥ì°½ + / ëª…ë ¹ì–´  â”‚  â”‚                   â”‚
â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  BOTTOM BAR: ë¹„ìš© Â· í† í° ì‚¬ìš©ëŸ‰ Â· ì„¸ì…˜ ìƒíƒœ           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## í•µì‹¬ ì•„í‚¤í…ì²˜

```
ë¸Œë¼ìš°ì € â†WebSocketâ†’ Express ì„œë²„ â†SDK query()â†’ Claude CLI ë°”ì´ë„ˆë¦¬
```

- SDK `query()` ë¹„ë™ê¸° ì œë„ˆë ˆì´í„°, `resume: sessionId`ë¡œ ì„¸ì…˜ ì´ì–´í•˜ê¸°
- `CLAUDECODE` í™˜ê²½ë³€ìˆ˜ ì œê±° í•„ìˆ˜
- WebSocket í”„ë¡œí† ì½œ: chat, abort, file_read/write/tree, set_active_session, reconnect
- `sendToSession` ê°„ì ‘ ì „ì†¡ (ì„¸ì…˜ ê²©ë¦¬ + ì¬ì—°ê²° ì§€ì›)
- `sessionClients` ë§µ (sessionId â†’ clientId) + epoch ê¸°ë°˜ stale loop ë°©ì§€
- chokidar íŒŒì¼ ê°ì‹œ â†’ broadcast
- ì—­í• ë³„ permissionMode (adminâ†’bypass, userâ†’acceptEdits)
- ë™ì‹œ ì„¸ì…˜ ìƒí•œ + 5ë¶„ hang íƒ€ì´ë¨¸

---

## ì™„ë£Œëœ Phase ìš”ì•½

> ìƒì„¸ ì„¤ê³„ ë‚´ìš©ì€ `plan_done.md`, êµ¬í˜„ ì´ë ¥ì€ `history.md` ì°¸ì¡°.

| Phase | ë‚´ìš© | ìƒíƒœ |
|-------|------|------|
| **1** | Core Chat + MD ë Œë”ë§ (SDK ì—°ë™, WS, ì±„íŒ… UI, JWT) | âœ… |
| **2** | íŒŒì¼ ì‹œìŠ¤í…œ + CodeMirror ì—ë””í„° + ì„¸ì…˜ UX | âœ… |
| **3** | ë©”ì‹œì§€ ì˜ì†í™” + í•€ë³´ë“œ + ì„¤ì • íŒ¨ë„ + UI í´ë¦¬ì‹œ | âœ… |
| **3.5** | ToolUseCard ì¹© ë ˆì´ì•„ì›ƒ + DB ë§ˆì´ê·¸ë ˆì´ì…˜ | âœ… |
| **4** | ContextPanel ê°•í™”, í”„ë¡¬í”„íŠ¸, ìŠ¬ë˜ì‹œ ëª…ë ¹ì–´, ì²¨ë¶€ ì¹©, ì•ˆì •ì„± | âœ… |
| **4.5** | ContextPanel íŒŒì¼ í¸ì§‘ ì•ˆì •ì„± (ì¶©ëŒ ê°ì§€, Ctrl+S, ë¯¸ì €ì¥ ê°€ë“œ) | âœ… |
| **5** | ëª¨ë¸ ì…€ë ‰í„°, ì„¸ì…˜ ìë™ ì´ë¦„, ì„¸ì…˜ ìš”ì•½ ì¹´ë“œ | âœ… |
| **6A** | ì„¸ì…˜ ì—°ì†ì„±/ë³µì›ë ¥ (WS ì¬ì—°ê²°, ì„œë²„ ì¬ì‹œì‘ ê°ì§€) | âœ… |
| **7** | Git ìë™ ìŠ¤ëƒ…ìƒ· (autoCommit, rollback, ë²„ì „ íƒ­) | âœ… |
| - | ì„¸ì…˜ ê²©ë¦¬ ìˆ˜ì • + ìˆœìˆ˜ í•¨ìˆ˜ ì¶”ì¶œ + í…ŒìŠ¤íŠ¸ 39ê°œ | âœ… |
| - | Plan mode ë Œë”ë§ ìˆ˜ì • | âœ… |
| - | PM2 í†µì¼ ê´€ë¦¬ | âœ… |
| - | ì„¸ì…˜ ì´ë¦„ í¸ì§‘ UX (ì—°í•„ ì•„ì´ì½˜, ì»¨í…ìŠ¤íŠ¸ ë©”ë‰´) | âœ… |
| - | ë™ì‹œ ì„¸ì…˜ ìŠ¤íŠ¸ë¦¬ë° + ì‚¬ì´ë“œë°” ìƒíƒœ í‘œì‹œ | âœ… |
| - | ì‹¤íŒ¨ ë©”ì‹œì§€ ê°ì§€ + ì¬ì „ì†¡ (orphan detection) | âœ… |
| - | Mermaid ë¬´í•œ ë£¨í”„ ìˆ˜ì • + ë©”ì‹œì§€ ë³µì‚¬ ë²„íŠ¼ | âœ… |
| - | CWD í”¼ì»¤ + Breadcrumb ë„¤ë¹„ê²Œì´ì…˜ | âœ… |
| - | Plan Mode + AskUserQuestion ì‘ë‹µ UI | âœ… |
| - | ëª¨ë°”ì¼ ë°˜ì‘í˜• UI (MobileTabBar) | âœ… |
| - | ë‹¤í¬/ë¼ì´íŠ¸ í…Œë§ˆ | âœ… |
| - | Admin ì‚¬ìš©ì ê´€ë¦¬ + í´ë” ì œí•œ | âœ… |
| - | SDK ë§ˆì´ê·¸ë ˆì´ì…˜ (claude-agent-sdk + Skills í™œì„±í™”) | âœ… |
| - | íŒŒì¼ ì—…ë¡œë“œ | âœ… |

---

## ìµœê·¼ ì™„ë£Œ (2026-02-23)

- [x] Mermaid ë¦¬-ë Œë” ë¬´í•œ ë£¨í”„ â€” `useMemo` ë©”ëª¨ì´ì œì´ì…˜ìœ¼ë¡œ í•´ê²°
- [x] ëŒ€í™” ë‚´ìš© ë¶€ë¶„ ë³µì‚¬ â€” CopyButton (ë©”ì‹œì§€ + ì½”ë“œë¸”ë¡)
- [x] ë™ì‹œ ì„¸ì…˜ ìŠ¤íŠ¸ë¦¬ë° â€” abort ì œê±°, epoch guard ì •ë¦¬
- [x] ì‚¬ì´ë“œë°” ìŠ¤íŠ¸ë¦¬ë° í‘œì‹œ â€” ë…¹ìƒ‰ í„ìŠ¤ ì¸ë””ì¼€ì´í„° + `session_status` broadcast
- [x] ì‹¤íŒ¨ ë©”ì‹œì§€ ê°ì§€ + ì¬ì „ì†¡ â€” orphan message detection (pendingâ†’delivered/failed)
- [x] ì—ëŸ¬ ë¡œê¹… ê°•í™” â€” ë¹ˆ catch ë¸”ë¡ì— console.error/warn ì¶”ê°€
- [x] CWD í”¼ì»¤ â€” ì‚¬ì´ë“œë°” CWD ë“œë¡­ë‹¤ìš´ + Breadcrumb (commit 5c5aaf85, 93168f0d)
- [x] Plan Mode UI â€” AskUserQuestion FloatingQuestionCard + EnterPlanMode/ExitPlanMode ë°°ë„ˆ (commit 8f316020, bf9600cc)
- [x] ëª¨ë°”ì¼ ë°˜ì‘í˜• â€” MobileTabBar + ë°˜ì‘í˜• ê·¸ë¦¬ë“œ (commit 59a33aca)
- [x] Admin ì‚¬ìš©ì ê´€ë¦¬ â€” `/admin/users` CRUD + per-user `allowed_path` (commit 90e65394)
- [x] SDK ë§ˆì´ê·¸ë ˆì´ì…˜ â€” `@anthropic-ai/claude-agent-sdk` + `settingSources` â†’ `Skill` ë„êµ¬ í™œì„±í™” (commit 224086c0)

---

## TODO / ë°±ë¡œê·¸

### âœ… Admin ì‚¬ìš©ì ê´€ë¦¬ â€” ì™„ë£Œ

- [x] `/api/admin/users` CRUD (ëª©ë¡, ìƒì„±, ìˆ˜ì •, ë¹„ë°€ë²ˆí˜¸ ë¦¬ì…‹, ì‚­ì œ)
- [x] SettingsPanel ë‚´ ì‚¬ìš©ì ê´€ë¦¬ UI (ì—­í• , allowed_path)
- [x] adminMiddleware ê¶Œí•œ ë³´í˜¸
- ~~ì‹œìŠ¤í…œ ìƒíƒœ, í™œì„± ì„¸ì…˜ ëª¨ë‹ˆí„°ë§, ë¹„ìš© ì°¨íŠ¸~~ â€” ë¶ˆí•„ìš”

### ğŸ”´ ë°ëª¨ ì½˜í…ì¸  (Sample Workspace)

**ëª©ì :** ì²˜ìŒ ì ‘ì†í•œ ì‚¬ìš©ìê°€ ë°”ë¡œ ì²´í—˜í•  ìˆ˜ ìˆëŠ” ìƒ˜í”Œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤.
business_ai í”„ë¡œì íŠ¸ êµ¬ì¡°ì—ì„œ ì°©ì•ˆ.

**ìƒ˜í”Œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ êµ¬ì¡°:**
```
/workspace/demo/
â”œâ”€â”€ CLAUDE.md              â† ì›Œí¬ìŠ¤í˜ì´ìŠ¤ ì•ˆë‚´ (Claudeê°€ ì½ëŠ” ì»¨í…ìŠ¤íŠ¸)
â”œâ”€â”€ principles/
â”‚   â”œâ”€â”€ core-values.md     â† ì¡°ì§ í•µì‹¬ ê°€ì¹˜
â”‚   â””â”€â”€ business-guide.md  â† ë¹„ì¦ˆë‹ˆìŠ¤ ì›ì¹™
â”œâ”€â”€ departments/
â”‚   â”œâ”€â”€ marketing/
â”‚   â”‚   â”œâ”€â”€ guidelines.md
â”‚   â”‚   â””â”€â”€ sops/social-media-campaign.md
â”‚   â”œâ”€â”€ finance/
â”‚   â”‚   â”œâ”€â”€ guidelines.md
â”‚   â”‚   â””â”€â”€ policies/expense-approval.md
â”‚   â””â”€â”€ product/
â”‚       â”œâ”€â”€ guidelines.md
â”‚       â””â”€â”€ sops/feature-launch-checklist.md
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ sop.md             â† SOP ì–‘ì‹
â”‚   â”œâ”€â”€ policy.md          â† ì •ì±… ì–‘ì‹
â”‚   â””â”€â”€ report.md          â† ë³´ê³ ì„œ ì–‘ì‹
â””â”€â”€ reports/
    â””â”€â”€ weekly-summary.md  â† ì£¼ê°„ ìš”ì•½ ìƒ˜í”Œ
```

**ìŠ¬ë˜ì‹œ ëª…ë ¹ì–´ ìƒ˜í”Œ:**
- `/generate-report` â€” ë¶€ì„œë³„ ë³´ê³ ì„œ ìƒì„±
- `/analyze` â€” ë°ì´í„° íŒŒì¼ ë¶„ì„ + ì¸ì‚¬ì´íŠ¸
- `/summarize-docs` â€” í´ë” ë‚´ ë¬¸ì„œ ìš”ì•½

**êµ¬í˜„ ë²”ìœ„:**
- [ ] ìƒ˜í”Œ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ íŒŒì¼ ìƒì„± (ìœ„ êµ¬ì¡°)
- [ ] ìŠ¬ë˜ì‹œ ëª…ë ¹ì–´ 3ê°œ ì‘ì„± (`~/.claude/commands/`)
- [ ] ì„¸ì…˜ CWDë¥¼ ë°ëª¨ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ë¡œ ê¸°ë³¸ ì„¤ì • ê°€ëŠ¥í•˜ê²Œ
- [ ] ì²« ì ‘ì† ì‹œ ê°€ì´ë“œ ë©”ì‹œì§€ or ì˜¨ë³´ë”© ì„¸ì…˜

### âœ… ì„¸ì…˜ CWD (ì‘ì—… ë””ë ‰í† ë¦¬) â€” ì™„ë£Œ

- [x] BottomBar cwd í´ë¦­ â†’ í´ë” í”¼ì»¤ ë“œë¡­ë‹¤ìš´
- [x] ì„¸ì…˜ cwd ë³€ê²½ API + chat ë©”ì‹œì§€ì— cwd ë°˜ì˜
- [x] ìƒˆ ì„¸ì…˜ ìƒì„± ì‹œ í˜„ì¬ ì„¸ì…˜ì˜ cwd ìƒì†
- [x] Breadcrumb ë„¤ë¹„ê²Œì´ì…˜

### âœ… Plan Mode + AskUserQuestion ì‘ë‹µ UI â€” ì™„ë£Œ

- [x] `AskUserQuestion` ì „ìš© UI (FloatingQuestionCard): ì§ˆë¬¸ + ì˜µì…˜ ë²„íŠ¼ â†’ ì‚¬ìš©ì ì„ íƒ â†’ SDK ì‘ë‹µ ì „ë‹¬
- [x] `EnterPlanMode`/`ExitPlanMode` ë°°ë„ˆ
- [x] ë¯¸ì²˜ë¦¬ SDK ë©”ì‹œì§€ fallback ë Œë”ë§

### âœ… ì„¸ì…˜ UX â€” ì™„ë£Œ
- [x] ì„¸ì…˜ ë§ˆì§€ë§‰ ëŒ€í™” ì‹œê°„ í‘œì‹œ (ìƒëŒ€ ì‹œê°„, ì •ë ¬)
- ~~ì´ë¦„ ë³€ê²½ í›„ ì •ë ¬ ìˆœì„œ~~ â€” ì •ë ¬ì€ updated_at ê¸°ì¤€ì´ë¼ ë¬´ê´€, ì œê±°

### âœ… ì„¸ì…˜ ì—°ì†ì„± â€” ì‹¤ì§ˆì  ì™„ë£Œ
- [x] WS ì¬ì—°ê²° êµ¬í˜„ ì™„ë£Œ
- [x] SDK resume ë™ì‘ í™•ì¸
- ~~ê·¹ë‹¨ì  ì—£ì§€ ì¼€ì´ìŠ¤ (ìŠ¤íŠ¸ë¦¬ë° ì¤‘ ì„œë²„ ì¬ì‹œì‘ + resume ë³µêµ¬)~~ â€” í˜„ì¬ ìˆ˜ì¤€ìœ¼ë¡œ ì¶©ë¶„

### ğŸŸ¢ ì „ì²´ ëŒ€í™” ë‚´ìš© ê³µìœ 
- A) ë§ˆí¬ë‹¤ìš´ ë‚´ë³´ë‚´ê¸° (ìš°ì„ ), B) ê³µìœ  ë§í¬ (í™•ì¥)

---

## Phase 8: ë©€í‹°ìœ ì € ì‘ì—… ê³µê°„ â€” "ë‚´ ì±…ìƒ / íšŒì˜ì‹¤ / ë‚¨ì˜ ì±…ìƒ"

5ì¸ ë¦¬ì„œì¹˜/ë¶„ì„ íŒ€ì´ ë‹¨ì¼ VMì„ ê³µìœ . ì„œë¡œ ë°©í•´ ì—†ì´ íŒ€ ìì›ì— ì ‘ê·¼.

### í´ë” êµ¬ì¡°
```
/workspace/
  /team/
    /reports/     â† ì™„ì„± ë³´ê³ ì„œ (ë³¸ì¸ íŒŒì¼ë§Œ ì“°ê¸° or admin)
    /data/        â† ê³µìœ  ë°ì´í„°ì…‹ (ì½ê¸°/ì“°ê¸° ììœ )
    /templates/   â† ë³´ê³ ì„œ ì–‘ì‹ (ì½ê¸° ì „ìš©, adminë§Œ ìˆ˜ì •)
  /users/
    /alice/       â† Alice ê°œì¸ ì‘ì—… ê³µê°„
    /bob/         â† Bob ê°œì¸ ì‘ì—… ê³µê°„
```

### ê¶Œí•œ ëª¨ë¸ (3ë‹¨ê³„)
| ì˜ì—­ | ë³´ê¸° | í¸ì§‘ | Claude ì‘ì—… | ë¹„ìœ  |
|------|------|------|------------|------|
| ë‚´ í´ë” | O | O | O | ë‚´ ì±…ìƒ |
| ê³µìœ  í´ë” | O | ê·œì¹™ë³„ | ê·œì¹™ë³„ | íšŒì˜ì‹¤ |
| ë‹¤ë¥¸ ì‚¬ëŒ í´ë” | O | X | X | ë‚¨ì˜ ì±…ìƒ |

### êµ¬í˜„ ë²”ìœ„
- ìœ ì €ë³„ í´ë” ìë™ ìƒì„±, `isWriteAllowed()` ê²½ë¡œ ê°€ë“œ
- ì„ íƒì  git worktree (ë¹„ê°œë°œìì—ê²Œ git ìš©ì–´ ë…¸ì¶œ ì•ˆ í•¨)
- íŒŒì¼ ë‹¨ìœ„ "ê³µìœ  í´ë”ì— ë‚´ë³´ë‚´ê¸°"

### ì„ í–‰ ì¡°ê±´
- ì„¸ì…˜ CWD ì„¤ê³„ (ìœ„ ë°±ë¡œê·¸)
- ì—­í• ë³„ permissionMode ì ìš© (ì™„ë£Œ)

---

## ğŸŸ¡ ì›Œí¬í”Œë¡œìš° ìë™í™” (Kanban + Cron) â€” ê¸°íš ì „

Claudeë¥¼ í™œìš©í•œ ë°˜ë³µ ì‘ì—… ìë™í™”. ì¹¸ë°˜ ë³´ë“œ + cron íŠ¸ë¦¬ê±°.

**ê°€ëŠ¥ ìœ ì¦ˆì¼€ì´ìŠ¤:**
- ë§¤ì¼ ë°ì´í„° ìˆ˜ì§‘ â†’ ìš”ì•½ ë³´ê³ ì„œ â†’ Slack ì „ì†¡
- íŒŒì¼ ë³€ê²½ â†’ ìë™ ì½”ë“œ ë¦¬ë·°
- ì£¼ê°„ ë¦¬ì„œì¹˜ íƒœìŠ¤í¬ ìˆœì°¨ ì²˜ë¦¬

**í˜„ì¬ ìƒíƒœ:** ì•„ì´ë””ì–´ ë‹¨ê³„.

---

## Phase 6: ëª¨ë°”ì¼ + íŒŒì¼ ì—…ë¡œë“œ + ë°°í¬

1. [x] ë¡œì»¬ íŒŒì¼ ì—…ë¡œë“œ â€” ì™„ë£Œ
2. [x] ëª¨ë°”ì¼ ë°˜ì‘í˜• (í•˜ë‹¨ íƒ­ë°”, â‰¤768px) â€” MobileTabBar êµ¬í˜„ ì™„ë£Œ
3. [x] ë‹¤í¬/ë¼ì´íŠ¸ í…Œë§ˆ â€” slate-tinted palette ì™„ë£Œ
4. ~~ë¹„ìš© ì¶”ì  ëŒ€ì‹œë³´ë“œ~~ â€” ë¶ˆí•„ìš”
5. [ ] Docker + Cloudflare Tunnel + PWA

---

## ë°°í¬ ì•„í‚¤í…ì²˜ (Phase 6)

```
ì‚¬ìš©ì ë¸Œë¼ìš°ì € â†’ HTTPS(Cloudflare Tunnel) â†’ Docker Compose(Caddy + claude-desk + cloudflared)
```

- **Tier 1: Docker Compose** â€” 1ê°œ ëª…ë ¹ìœ¼ë¡œ ì „ì²´ ìŠ¤íƒ, ì›í´ë¦­ ì„¤ì¹˜ ìŠ¤í¬ë¦½íŠ¸
- **Tier 2: Cloudflare Tunnel** â€” ë¬´ë£Œ HTTPS, ê³ ì • URL, í¬íŠ¸ ì—´ê¸° ë¶ˆí•„ìš”
- **Tier 3: PWA** â€” í™ˆ í™”ë©´ ì„¤ì¹˜, ë¸Œë¼ìš°ì € í¬ë¡¬ ì—†ì´ ì‹¤í–‰
- **Tier 4: í´ë¼ìš°ë“œ** â€” Fly.io/Railway ì›í´ë¦­ ë°°í¬

### ì„¤ì¹˜ ì‹œë‚˜ë¦¬ì˜¤
- A) ë‚´ PCì—ì„œ í˜¼ì: `docker run -d ...`
- B) íŒ€ ì›ê²© ì ‘ì†: `install.sh` + Cloudflare Tunnel
- C) ì„œë²„ ê´€ë¦¬ ì‹«ì–´: Fly.io fork â†’ í™˜ê²½ë³€ìˆ˜ â†’ ìë™ ë°°í¬

---

## í”„ë¡œì íŠ¸ êµ¬ì¡°

```
claude-desk/
  package.json, tsconfig.json, vite.config.ts, vitest.config.ts
  ecosystem.config.cjs          -- PM2 ì„¤ì •

  backend/
    index.ts                    -- Express + WS ì„œë²„ ì—”íŠ¸ë¦¬
    config.ts                   -- ì„¤ì • (í¬íŠ¸, ê²½ë¡œ, ì¸ì¦, ëª¨ë¸)
    db/schema.ts                -- SQLite ìŠ¤í‚¤ë§ˆ
    services/
      claude-sdk.ts, file-system.ts, pin-manager.ts,
      session-manager.ts, message-store.ts, command-loader.ts,
      auth.ts, auto-namer.ts, summarizer.ts, git-manager.ts
    routes/
      api.ts                    -- REST ì—”ë“œí¬ì¸íŠ¸
      ws-handler.ts             -- WebSocket ë©”ì‹œì§€ ë¼ìš°íŒ…
      session-guards.ts         -- ì„¸ì…˜ ê²©ë¦¬ ìˆœìˆ˜ í•¨ìˆ˜
      session-guards.test.ts    -- ìœ ë‹› í…ŒìŠ¤íŠ¸ (13ê°œ)
      ws-handler.test.ts        -- í†µí•© í…ŒìŠ¤íŠ¸ (8ê°œ)

  frontend/src/
    App.tsx, main.tsx
    stores/                     -- chat, file, session, pin, prompt, model, git, settings
    components/
      layout/                   -- Header, Sidebar, ContextPanel, ResizeHandle, ModelSelector
      chat/                     -- ChatPanel, MessageBubble, ToolUseCard, InputBox, AttachmentChip
      files/                    -- FileTree, MarkdownRenderer
      editor/                   -- CodeEditor
      sessions/                 -- SessionItem, SummaryCard
      pinboard/                 -- PinList
      prompts/                  -- PromptItem, PromptEditor
      git/                      -- GitPanel
      settings/                 -- SettingsPanel
      auth/                     -- LoginPage
    hooks/
      useWebSocket.ts, useClaudeChat.ts
    utils/
      message-parser.ts, session-filters.ts
      session-filters.test.ts   -- ìœ ë‹› í…ŒìŠ¤íŠ¸ (13ê°œ)
    components/chat/
      InputBox.test.tsx          -- ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸ (5ê°œ)
```

---

## ê²€ì¦ ë°©ë²•

1. SDK ì—°ë™: "hello" â†’ Claude ì‘ë‹µ ìŠ¤íŠ¸ë¦¬ë° âœ…
2. ì„¸ì…˜ ì´ì–´í•˜ê¸°: ìƒˆë¡œê³ ì¹¨ â†’ íˆìŠ¤í† ë¦¬ ì„ íƒ â†’ ë§¥ë½ ìœ ì§€ âœ…
3. íŒŒì¼ í¸ì§‘: Claude íŒŒì¼ ìƒì„± â†’ ì‹¤ì‹œê°„ ë°˜ì˜ â†’ í´ë¦­ ì—´ê¸°/í¸ì§‘
4. Skills: `/` ì…ë ¥ â†’ ë“œë¡­ë‹¤ìš´ â†’ ì„ íƒ ì‹¤í–‰ âœ…
5. SSH í„°ë„ ì ‘ì† âœ…
6. í•€ë³´ë“œ: .html í•€ â†’ iframe ë Œë”ë§ â†’ ë“œë˜ê·¸â†’ì±„íŒ…
7. í”„ë¡¬í”„íŠ¸: ì¶”ê°€ â†’ ë¯¸ë¦¬ë³´ê¸° â†’ ë“œë˜ê·¸â†’InputBox
8. í…ŒìŠ¤íŠ¸: `npm run test` â†’ 39ê°œ í†µê³¼ âœ…
9. ë¹Œë“œ: `npm run build` â†’ íšŒê·€ ì—†ìŒ âœ…

---

## Dev Mode (HMR ê°œë°œ ì›Œí¬í”Œë¡œìš°)

### ë°°ê²½
`npm run restart` (production build) ëŠ” ë§¤ë²ˆ ~40ì´ˆ ì†Œìš”. ê°œë°œ ì¤‘ ë¹ˆë²ˆí•œ ìˆ˜ì •ì— ë¹„íš¨ìœ¨ì .

### í•´ê²°
Vite dev server + tsx watch ì¡°í•©ìœ¼ë¡œ ì¦‰ì‹œ ë°˜ì˜:
- Frontend: Vite HMR â†’ CSS/ì»´í¬ë„ŒíŠ¸ ë³€ê²½ ì¦‰ì‹œ ë°˜ì˜
- Backend: tsx watch â†’ íŒŒì¼ ë³€ê²½ ì‹œ ~2ì´ˆ ìë™ ì¬ì‹œì‘
- ê°™ì€ í¬íŠ¸(32354)ë¡œ ì›ê²© ì ‘ì† ê°€ëŠ¥

### ì‚¬ìš©ë²•
```bash
# ê°œë°œ ëª¨ë“œ ì‹œì‘
pm2 stop claude-desk
npm run dev

# í”„ë¡œë•ì…˜ ë³µê·€
Ctrl+C
npm run restart
```

### í¬íŠ¸ êµ¬ì¡°
- :32354 â€” Vite dev server (ë¸Œë¼ìš°ì € ì ‘ì†)
- :32355 â€” Backend (Viteê°€ /api, /ws í”„ë¡ì‹œ)
